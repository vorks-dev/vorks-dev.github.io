window.onload = () => {
    init();
}

function init() {
    replaceIcons();
    fillAppCloud();
}

const iconPaths = {
    "bluesky-icon": "m 16.991667,13.613142 c -0.1375,-0.01667 -0.279167,-0.03333 -0.416667,-0.05417 0.141667,0.01667 0.279167,0.0375 0.416667,0.05417 z M 12,10.796475 C 10.9125,8.6839749 7.9541667,4.7464752 5.2041666,2.8048084 2.5666668,0.9423084 1.5625001,1.2631417 0.9000001,1.5631417 c -0.7625,0.3458333 -0.9,1.5166667 -0.9,2.2041667 0,0.6875 0.3791666,5.6500005 0.625,6.4791676 0.8125,2.7375 3.7125,3.662499 6.3833332,3.362499 0.1375003,-0.02083 0.2750001,-0.0375 0.4166667,-0.05833 -0.1374998,0.02083 -0.2749997,0.04167 -0.4166667,0.05833 -3.9124998,0.583334 -7.3874999,2.008334 -2.8291665,7.079167 5.0125001,5.191667 6.8666672,-1.1125 7.8208332,-4.308333 0.954167,3.195833 2.05,9.270833 7.733334,4.308333 4.266666,-4.308333 1.170833,-6.5 -2.741667,-7.079167 -0.1375,-0.01667 -0.279167,-0.03333 -0.416667,-0.05417 0.141667,0.01667 0.279167,0.0375 0.416667,0.05417 C 19.6625,13.904809 22.558334,12.979809 23.375,10.246476 23.620833,9.4173089 24,4.458975 24,3.7673084 24,3.0756417 23.8625,1.9048084 23.1,1.5631417 22.441667,1.2673084 21.433334,0.9423084 18.8,2.8048084 16.045833,4.7464752 13.0875,8.6839749 12,10.796475 Z",
    "github-icon": "m 8.0274168,19.141755 c 0,0.09677 -0.1112903,0.174193 -0.251613,0.174193 -0.1596772,0.01451 -0.2709676,-0.06291 -0.2709676,-0.174193 0,-0.09678 0.1112904,-0.174194 0.2516128,-0.174194 0.1451613,-0.01451 0.2709678,0.06291 0.2709678,0.174194 z M 6.5225781,18.924012 c -0.03387,0.09677 0.062904,0.208065 0.2080645,0.237097 0.1258065,0.04838 0.2709678,0 0.3,-0.09677 0.029032,-0.09677 -0.062903,-0.208065 -0.2080645,-0.251613 -0.1258065,-0.03387 -0.266129,0.01451 -0.3,0.11129 z m 2.1387095,-0.08226 c -0.1403225,0.03387 -0.2370967,0.125807 -0.2225806,0.237097 0.014516,0.09677 0.1403228,0.159678 0.2854839,0.125807 0.1403225,-0.03387 0.2370967,-0.125807 0.2225808,-0.222581 -0.014517,-0.09193 -0.1451615,-0.15484 -0.2854841,-0.140323 z M 11.845159,0.29982124 C 5.1338685,0.29982124 -1.95e-6,5.3949822 -1.95e-6,12.106272 c 0,5.366127 3.37741915,9.958063 8.20161225,11.574192 0.619355,0.11129 0.8370967,-0.270968 0.8370967,-0.585484 0,-0.3 -0.014516,-1.954838 -0.014516,-2.970967 0,0 -3.3870966,0.725806 -4.098387,-1.441936 0,0 -0.5516128,-1.408064 -1.3451611,-1.770968 0,0 -1.1080644,-0.759676 0.077419,-0.745159 0,0 1.2048385,0.09677 1.8677417,1.248385 1.0596773,1.867742 2.8354838,1.330645 3.5274192,1.011291 0.1112903,-0.774194 0.4258069,-1.311291 0.7741939,-1.630646 -2.7048393,-0.3 -5.4338715,-0.691934 -5.4338715,-5.346772 0,-1.330645 0.3677418,-1.9983868 1.1419354,-2.8500008 -0.1258065,-0.314515 -0.5370967,-1.611289 0.1258063,-3.285483 1.0112903,-0.314516 3.3387096,1.306452 3.3387096,1.306452 0.9677422,-0.270968 2.0080645,-0.411291 3.0387095,-0.411291 1.030646,0 2.070968,0.140323 3.038709,0.411291 0,0 2.32742,-1.625807 3.338709,-1.306452 0.662904,1.679032 0.251613,2.970968 0.125806,3.285483 0.774195,0.856452 1.248388,1.5241938 1.248388,2.8500008 0,4.669355 -2.849999,5.041934 -5.554838,5.346772 0.445161,0.382259 0.822581,1.108065 0.822581,2.245161 0,1.630646 -0.01451,3.648388 -0.01451,4.045161 0,0.314517 0.222581,0.696775 0.837096,0.585485 4.838709,-1.606452 8.119355,-6.198388 8.119355,-11.564515 0,-6.7112898 -5.443548,-11.80645076 -12.154838,-11.80645076 z M 4.7032234,16.988528 c -0.062904,0.04838 -0.048387,0.159678 0.03387,0.251613 0.077419,0.07742 0.1887097,0.111291 0.2516129,0.04839 0.062904,-0.04839 0.048387,-0.159678 -0.03387,-0.251614 -0.077419,-0.07742 -0.1887097,-0.11129 -0.2516129,-0.04838 z M 4.1806428,16.596593 c -0.03387,0.06291 0.014517,0.140324 0.1112903,0.18871 0.077419,0.04838 0.1741935,0.03387 0.2080645,-0.03387 0.03387,-0.06291 -0.014517,-0.140323 -0.1112903,-0.188709 -0.096774,-0.02904 -0.1741936,-0.01451 -0.2080645,0.03387 z m 1.5677418,1.722581 c -0.077419,0.06291 -0.048387,0.208065 0.062904,0.3 0.1112904,0.11129 0.2516129,0.125806 0.3145162,0.04838 0.062903,-0.06291 0.03387,-0.208064 -0.062904,-0.3 -0.1064517,-0.111289 -0.251613,-0.125805 -0.3145162,-0.04838 z M 5.1967717,17.607883 c -0.077419,0.04839 -0.077419,0.174195 0,0.285485 0.077419,0.111289 0.2080645,0.159677 0.2709678,0.111289 0.077419,-0.06291 0.077419,-0.188709 0,-0.299999 -0.067742,-0.11129 -0.1935484,-0.159678 -0.2709678,-0.09677 z",
    "instagram-icon": "m 12.002671,5.8480749 a 6.1572991,6.1572991 0 1 0 -0.03212,12.3145561 6.1572991,6.1572991 0 1 0 0.03212,-12.3145561 z m -0.03212,2.1630786 a 3.9942318,3.9942318 0 1 1 0.03212,7.9883985 3.9942318,3.9942318 0 1 1 -0.03212,-7.9883985 z m 5.00078,-2.4147239 a 1.4349135,1.4349135 0 1 1 2.869827,0 1.4349135,1.4349135 0 1 1 -2.869827,0 z m 6.944338,1.4563302 C 23.824647,5.1306182 23.38561,3.4279969 21.977466,2.0252084 20.574678,0.62241981 18.872057,0.18337911 16.949916,0.08700431 c -1.981038,-0.1124367 -7.9187963,-0.1124367 -9.8998334,0 C 5.1332952,0.17802551 3.430674,0.61706561 2.0225313,2.0198542 0.6143885,3.4226428 0.180702,5.125264 0.0843272,7.0474056 c -0.1124367,1.9810376 -0.1124367,7.9187954 0,9.8998324 0.091021,1.922141 0.5300613,3.624762 1.9382041,5.027551 1.4081427,1.402788 3.1054098,1.841829 5.0275513,1.938204 1.9810371,0.11244 7.9187954,0.11244 9.8998334,0 1.922141,-0.09102 3.624762,-0.530062 5.02755,-1.938204 1.402789,-1.402789 1.84183,-3.10541 1.938204,-5.027551 0.112441,-1.981037 0.112441,-7.9134408 -10e-7,-9.8944782 z m -2.55929,12.0200772 c -0.417624,1.049414 -1.226101,1.857891 -2.28087,2.28087 -1.579475,0.626435 -5.327384,0.481874 -7.072838,0.481874 -1.745455,0 -5.4987179,0.139208 -7.0728394,-0.481874 -1.0494143,-0.417624 -1.8578917,-1.226102 -2.2808699,-2.28087 -0.6264362,-1.579476 -0.481874,-5.327384 -0.481874,-7.072838 0,-1.745455 -0.139208,-5.4987172 0.481874,-7.0728387 0.417624,-1.0494144 1.2261014,-1.8578918 2.2808699,-2.28087 1.5794757,-0.6264361 5.3273844,-0.4818739 7.0728394,-0.4818739 1.745454,0 5.498716,-0.139208 7.072838,0.4818739 1.049414,0.4176241 1.857892,1.2261015 2.28087,2.28087 0.626436,1.5794757 0.481874,5.3273837 0.481874,7.0728387 0,1.745454 0.144562,5.498716 -0.481874,7.072838 z",
    "mastodon-icon": "m 23.193917,7.879773 c 0,-5.2063094 -3.411953,-6.7328507 -3.411953,-6.7328507 -3.347679,-1.53725393 -12.2444693,-1.52118503 -15.5600099,0 0,0 -3.41195377,1.5265413 -3.41195377,6.7328507 0,6.197222 -0.3535148,13.894204 5.65623727,15.485021 2.1692956,0.573122 4.0332834,0.696317 5.5330424,0.610617 2.720993,-0.149976 4.247535,-0.969489 4.247535,-0.969489 l -0.09106,-1.976468 c 0,0 -1.944332,0.610616 -4.129696,0.540984 -2.1639388,-0.07499 -4.4457163,-0.235677 -4.7992311,-2.892394 -0.032138,-0.246389 -0.048206,-0.498134 -0.048206,-0.744523 4.5849801,1.119463 8.5004261,0.487421 9.5716831,0.35887 3.004876,-0.35887 5.6241,-2.212145 5.956188,-3.904731 0.524917,-2.667431 0.482066,-6.507887 0.482066,-6.507887 z m -4.02257,6.706069 H 16.675318 V 8.4689643 c 0,-2.6620738 -3.428023,-2.7638432 -3.428023,0.3695837 v 3.347678 h -2.47996 V 8.838548 c 0,-3.1334269 -3.4280229,-3.0316575 -3.4280229,-0.3695837 V 14.585842 H 4.8379269 c 0,-6.5400242 -0.2785268,-7.9219458 0.9855565,-9.3734991 C 7.2107613,3.6643764 10.097799,3.562607 11.383308,5.5390763 l 0.621329,1.0444756 0.621329,-1.0444756 c 1.290865,-1.9871819 4.183259,-1.8639873 5.559825,-0.3267334 1.269439,1.4622659 0.985556,2.8388312 0.985556,9.3734991 z",
    "reddit-icon": "m 17.484375,6.5015625 c -1.18125,0 -2.170312,-0.8203125 -2.432813,-1.921875 -1.434374,0.2015625 -2.540624,1.4390625 -2.540624,2.925 v 0.00937 c 2.221875,0.084375 4.246874,0.7078125 5.854687,1.7015625 0.590625,-0.4546875 1.33125,-0.7265625 2.132813,-0.7265625 1.935937,0 3.501562,1.5656255 3.501562,3.5015625 0,1.396875 -0.815625,2.601562 -2.001562,3.164062 -0.1125,4.06875 -4.546875,7.340625 -9.993751,7.340625 -5.4468745,0 -9.8718745,-3.267187 -9.989062,-7.331249 C 0.825,14.60625 0,13.396875 0,11.990625 0,10.054688 1.565625,8.4890625 3.5015625,8.4890625 c 0.80625,0 1.546875,0.271875 2.1421875,0.73125 1.59375,-0.9890625 3.6,-1.6125 5.798438,-1.70625 V 7.5 c 0,-2.0765625 1.579687,-3.7921875 3.6,-4.0078125 0.229687,-1.134375 1.232812,-1.9875 2.442187,-1.9875 1.378125,0 2.498438,1.1203125 2.498438,2.4984375 0,1.378125 -1.120313,2.4984375 -2.498438,2.4984375 z M 7.3828125,11.971875 c -0.9796875,0 -1.8234375,0.975 -1.884375,2.245312 -0.060937,1.270313 0.8015625,1.785938 1.78125,1.785938 0.9796875,0 1.715625,-0.459375 1.771875,-1.729688 C 9.1078125,13.003125 8.3625,11.971875 7.378125,11.971875 Z M 18.515625,14.2125 c -0.05625,-1.270313 -0.9,-2.245312 -1.884375,-2.245312 -0.984375,0 -1.729687,1.03125 -1.673438,2.301562 0.05625,1.270313 0.792188,1.729688 1.771875,1.729688 0.979688,0 1.842188,-0.515625 1.78125,-1.785938 z m -2.817187,3.31875 c 0.07031,-0.16875 -0.04687,-0.360937 -0.229688,-0.379688 -1.078125,-0.107812 -2.245313,-0.168749 -3.459375,-0.168749 -1.214062,0 -2.38125,0.06094 -3.459375,0.168749 C 8.3671875,17.170313 8.25,17.3625 8.3203125,17.53125 8.925,18.975 10.35,19.9875 12.009375,19.9875 c 1.659375,0 3.084375,-1.012501 3.689063,-2.45625 z"
}

const apps = [
    {
        "name": "Gradia",
        "icon": "https://vorks-dev.github.io/gradia/img/app_icon.png",
        "url": "https://vorks-dev.github.io/apps/gradia/"
    },
    {
        "name": "Lysa",
        "icon": "https://vorks-dev.github.io/lysa/img/app_icon.png",
        "url": "https://vorks-dev.github.io/apps/lysa/"
    },
    {
        "name": "DataManager.js",
        "icon": "https://datamanager.js.org/logo.svg",
        "url": "https://vorks-dev.github.io/apps/datamanager.js"
    }
]

function replaceIcons() {
    // Select all <i> tags
    const icons = document.querySelectorAll('i');
  
    // Iterate over each <i> tag
    icons.forEach(icon => {
        // Find the matching class in the iconPaths object
        const matchedClass = Object.keys(iconPaths).find(cls => icon.classList.contains(cls));
        
        if (matchedClass) {
            // Get the corresponding SVG path
            const pathData = iconPaths[matchedClass];
            
            // Get the color and size from the <i> tag's styles
            const color = icon.dataset.color || icon.style.color || 'var(--font-color)';
            const size = icon.dataset.size || window.getComputedStyle(icon).fontSize || '1rem';
            
            // Create the SVG element
            const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            svg.setAttribute("viewBox", "0 0 24 24");
            svg.setAttribute("fill", color);
            svg.setAttribute("width", size);
            svg.setAttribute("height", size);
            svg.setAttribute("aria-hidden", "true");
            
            if(pathData.includes('<')) {
                icon.innerHTML = '';
                icon.appendChild(svg);
                svg.innerHTML = pathData;
                return;
            }

            // Create the path element
            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
            path.setAttribute("d", pathData);
            
            // Append the path to the SVG
            svg.appendChild(path);
            
            // Replace the <i> tag's content with the SVG
            icon.innerHTML = '';
            icon.appendChild(svg);
        }
    });
} 

//----- App Cloud -----//
async function fillAppCloud() {
    const appClouds = document.getElementsByClassName("appCloud");
    const appDiv = document.createElement("div");
    apps.forEach((app, i) => {
        const anchor = document.createElement("a");
        anchor.href = app.url;
        anchor.target = "_blank";

        const img = document.createElement("img");
        img.src = app.icon;
        img.title = app.name;

        anchor.appendChild(img);
        appDiv.appendChild(anchor);
    });

    for(const appCloud of appClouds) {
        appCloud.appendChild(appDiv);
    }
}